#	交易所部署

##	版本说明

此文档用于uenc版本为v1.5，请参考《PRC接口文档》中内容调用相关接口进行交易。

### 交易所交易过程

1.客户端通过create_tx_message接口向节点发起交易请求，包括from_addr，to_addr和fee等信息，节点创建交易体数据，客户端获得tx_data和tx_encode_hash信息。

2.客户端通过generate_sign接口向节点发送私钥和 tx_encode_hash 信息，节点对tx_encode_hash 

信息进行签名，客户端获得签名信息tx_signature。这里亦可使用本地动态库进行签名，详情请参考《动态库使用文档.md》。

3.客户端通过 send_tx 接口 将tx_data，public_key，tx_encode_hash和tx_signature发送到节点，该交易通过节点发送到全网进行签名验证，客户端得到该交易的tx_hash。

客户端将tx_hash信息留存，待交易确认时查询用。

4.客户端可用get_pending_transaction 

接口向节点发送地址信息获得当前地址发起的已挂起的交易哈希，判断是否和第4步留存的tx_hash一致来判断该交易是否在进行中，若交易进行中则不能再次发起交易，

需等待交易上链或是5分钟后挂起状态结束后再进行交易。

### 交易是否上链 
1.当已知发起交易的节点时，通过get_pending_transaction RPC接口查询发起交易节点的挂起交易列表中的广播时间，
以此延后10分钟后进行交易查询，当达到该交易已在全网60%以上的节点中上链，则视为交易成功。
若未达到60%的节点上链，则视为交易失败。
2.当未知发起交易节点时，通过confirm_transaction RPC接口将tx_hash信息发送给节点查询该交易是否在60%节点上建块，该接口返回建块节点的id。
若三次间隔10分钟的查询中每次超过60%节点上链，则视为成功；每次查询中0%节点上链，则视为失败；
当三次交易查询中任一一次在0%-60%之间，则通过get_pending_transaction RPC接口返回的节点信息，查询建块节点当中该交易建块时间，按此时间延后10分钟后进行交易查询，
若该交易已在全网60%以上的节点中上链的话，则视为交易成功。若未达到60%节点上链，则视为交易失败。
